<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/emat10006/libs/highlight/github.min.css"> <link rel=stylesheet  href="/emat10006/css/franklin.css"> <link rel=stylesheet  href="/emat10006/css/basic.css"> <link rel=icon  href="/emat10006/assets/favicon.png"> <title>Functions, exceptions and testing &mdash; Further Computer Programming</title> <header> <div class=blog-name ><a href="">EMAT10006: Further Computer Programming</a></div> <nav> <ul> <li><a href="/emat10006/">Overview</a> <li><a href="/emat10006/materials/">Materials</a> <li><a href="/emat10006/cheatsheet/">Cheatsheet</a> <li><a href="/emat10006/assignment/">Assignment</a> </ul> <img src="/emat10006/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=functions_exceptions_and_testing ><a href="#functions_exceptions_and_testing" class=header-anchor >Functions, exceptions and testing</a></h1> <h2 id=functions_in_a_script ><a href="#functions_in_a_script" class=header-anchor >Functions in a script</a></h2> <pre><code class="python hljs"><span class=hljs-comment ># myscript.py</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">double</span>(<span class=hljs-params >thing</span>):
    <span class=hljs-string >&quot;&quot;&quot;Doubles the thing&quot;&quot;&quot;</span>
    <span class=hljs-keyword >return</span> thing + thing

<span class=hljs-built_in >print</span>(double(<span class=hljs-number >2</span>))
<span class=hljs-built_in >print</span>(double([<span class=hljs-number >1</span>, <span class=hljs-number >2</span>]))
<span class=hljs-built_in >print</span>(double(<span class=hljs-string >&quot;foo&quot;</span>))</code></pre> <p>Run in the terminal:</p> <pre><code class="shell hljs"><span class=hljs-meta >$ </span><span class=language-bash >python myscript.py</span>
4
[1, 2, 1, 2]
&#x27;foofoo&#x27;</code></pre> <h2 id=functions_in_a_module ><a href="#functions_in_a_module" class=header-anchor >Functions in a module</a></h2> <pre><code class="python hljs"><span class=hljs-comment ># mymodule.py</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">double</span>(<span class=hljs-params >thing</span>):
    <span class=hljs-string >&quot;&quot;&quot;Doubles the thing&quot;&quot;&quot;</span>
    <span class=hljs-keyword >return</span> thing + thing</code></pre> <p>Run in the <em>Python</em> shell:</p> <pre><code class="python hljs"><span class=hljs-meta >&gt;&gt;&gt; </span><span class=hljs-keyword >from</span> mymodule <span class=hljs-keyword >import</span> double
<span class=hljs-meta >&gt;&gt;&gt; </span>double(<span class=hljs-number >4</span>)
<span class=hljs-number >8</span></code></pre> <h2 id=why_functions ><a href="#why_functions" class=header-anchor >Why functions</a></h2> <ul> <li><p>Break up program into small pieces</p> <li><p>Good function names improve readability</p> <li><p>Reuse code</p> <li><p>Don&#39;t repeat yourself &#40;DRY&#41;</p> <li><p>One place to fix bugs</p> </ul> <h2 id=case_study_datetime_module ><a href="#case_study_datetime_module" class=header-anchor >Case study: datetime module</a></h2> <p>Python stdlib datetime module: <a href="https://github.com/python/cpython/blob/master/Lib/datetime.py">https://github.com/python/cpython/blob/master/Lib/datetime.py</a></p> <ul> <li><p>2500 lines of code for the module in total</p> <li><p>Almost all code is in functions &#40;and methods&#41;</p> <li><p>Around 200 functions total</p> <li><p>Average function length is less than 10 lines&#33;</p> <li><p>Lots of comments and docstrings for explanation</p> </ul> <h2 id=function_naming ><a href="#function_naming" class=header-anchor >Function naming</a></h2> <ul> <li><p>Python convention is snake case: <code>some_function_name&#40;&#41;</code></p> <li><p>Variable and function names can explain code</p> <li><p>Think about the name in the context of where the function will be <em>called</em>.</p> <li><p>Use a leading underscore for internal functions e.g. <code>_is_leap&#40;&#41;</code></p> <li><p>Comments should explain non-obvious things</p> </ul> <h2 id=function_behaviour ><a href="#function_behaviour" class=header-anchor >Function behaviour</a></h2> <p>Pure function:</p> <ul> <li><p>Always returns the same value given the same input arguments</p> <li><p>Does not have any other &quot;side effects&quot;</p> </ul> <p>Example:</p> <ul> <li><p><code>sum</code> is a pure function</p> <li><p><code>print</code> is not &#40;side effects&#41;</p> <li><p><code>time</code> is not &#40;gives different values&#41;</p> </ul> <h2 id=categorising_functions ><a href="#categorising_functions" class=header-anchor >Categorising functions:</a></h2> <p>Input/output functions are never pure</p> <ul> <li><p>Input functions &#40;e.g. read from file&#41;</p> <li><p>Output functions &#40;e.g. print to screen&#41;</p> <li><p>Pure functions</p> </ul> <p>Every programme needs to have some inputs and outputs but you should try to put as much as possible of the code in pure functions.</p> <h2 id=function_names_and_grammar ><a href="#function_names_and_grammar" class=header-anchor >Function names and grammar</a></h2> <ul> <li><p>Name the function with a verb &#40;imperative tense&#41;:</p> <ul> <li><p><code>print&#40;obj&#41;</code></p> <li><p><code>load&#40;filename&#41;</code></p> <li><p><code>mylist.sort&#40;&#41;</code></p> </ul> <li><p>Name the function with a noun &#40;describe the return value&#41;</p> <ul> <li><p><code>min&#40;numbers&#41;</code></p> <li><p><code>len&#40;mylist&#41;</code></p> </ul> <li><p>An adjective</p> <ul> <li><p><code>sorted&#40;mylist&#41;</code></p> <li><p><code>mystring.upper&#40;&#41;</code></p> </ul> <li><p>Or a question?</p> <ul> <li><p><code>is_leap_year&#40;&#41;</code></p> <li><p><code>has_key&#40;&#41;</code></p> </ul> </ul> <h2 id=length_of_function_names ><a href="#length_of_function_names" class=header-anchor >Length of function names</a></h2> <ul> <li><p>Functions that are used a lot can have short names e.g. <code>len</code>, <code>sum</code> etc.</p> <li><p>Some conventions for shortening are well known e.g. <code>num_people</code> for <code>number_of_people</code>.</p> <li><p>Otherwise prefer longer and more explicit names.</p> </ul> <h2 id=good_names ><a href="#good_names" class=header-anchor >Good names</a></h2> <p>Compare these:</p> <pre><code class="python hljs"><span class=hljs-comment ># Call func1</span>
var1 = func1(var2)</code></pre> <pre><code class="python hljs"><span class=hljs-comment ># All components are equally weighted</span>
unit_mark = mean(component_marks)</code></pre> <p>Can you understand what is happening in each example?</p> <h2 id=raising_exceptions ><a href="#raising_exceptions" class=header-anchor >Raising exceptions</a></h2> <pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">get_first_name</span>(<span class=hljs-params >student_number</span>):
    <span class=hljs-string >&quot;&quot;&quot;Return first name of the student with this student number&quot;&quot;&quot;</span>

    <span class=hljs-keyword >if</span> student_number <span class=hljs-keyword >not</span> <span class=hljs-keyword >in</span> registered_students:
        <span class=hljs-keyword >raise</span> ValueError(<span class=hljs-string >&quot;No such student registered %s&quot;</span> % student_number)

    details = registered_students[student_number]
    <span class=hljs-keyword >return</span> details[<span class=hljs-string >&#x27;firstname&#x27;</span>]</code></pre> <p>Use exceptions when it is not possible to return something sensible</p> <h2 id=seeing_exceptions ><a href="#seeing_exceptions" class=header-anchor >Seeing Exceptions</a></h2> <pre><code class="python hljs"><span class=hljs-meta >&gt;&gt;&gt; </span>x = <span class=hljs-number >2</span>
<span class=hljs-meta >&gt;&gt;&gt; </span>x.upper()
Traceback (most recent call last):
  File <span class=hljs-string >&quot;&lt;stdin&gt;&quot;</span>, line <span class=hljs-number >1</span>, <span class=hljs-keyword >in</span> &lt;module&gt;
AttributeError: <span class=hljs-string >&#x27;int&#x27;</span> <span class=hljs-built_in >object</span> has no attribute <span class=hljs-string >&#x27;upper&#x27;</span>
<span class=hljs-meta >&gt;&gt;&gt; </span><span class=hljs-number >2</span> + [<span class=hljs-number >3</span>]
Traceback (most recent call last):
  File <span class=hljs-string >&quot;&lt;stdin&gt;&quot;</span>, line <span class=hljs-number >1</span>, <span class=hljs-keyword >in</span> &lt;module&gt;
TypeError: unsupported operand <span class=hljs-built_in >type</span>(s) <span class=hljs-keyword >for</span> +: <span class=hljs-string >&#x27;int&#x27;</span> <span class=hljs-keyword >and</span> <span class=hljs-string >&#x27;list&#x27;</span></code></pre> <h2 id=traceback ><a href="#traceback" class=header-anchor >Traceback</a></h2> <pre><code class="python hljs"><span class=hljs-meta >&gt;&gt;&gt; </span><span class=hljs-keyword >import</span> subprocess
<span class=hljs-meta >&gt;&gt;&gt; </span>subprocess.run(<span class=hljs-string >&#x27;foo&#x27;</span>)
Traceback (most recent call last):
  File <span class=hljs-string >&quot;&lt;stdin&gt;&quot;</span>, line <span class=hljs-number >1</span>, <span class=hljs-keyword >in</span> &lt;module&gt;
  File <span class=hljs-string >&quot;.../lib/python3.8/subprocess.py&quot;</span>, line <span class=hljs-number >489</span>, <span class=hljs-keyword >in</span> run
    <span class=hljs-keyword >with</span> Popen(*popenargs, **kwargs) <span class=hljs-keyword >as</span> process:
  File <span class=hljs-string >&quot;.../lib/python3.8/subprocess.py&quot;</span>, line <span class=hljs-number >854</span>, <span class=hljs-keyword >in</span> __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File <span class=hljs-string >&quot;.../lib/python3.8/subprocess.py&quot;</span>, line <span class=hljs-number >1702</span>, <span class=hljs-keyword >in</span> _execute_child
    <span class=hljs-keyword >raise</span> child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno <span class=hljs-number >2</span>] No such file <span class=hljs-keyword >or</span> directory: <span class=hljs-string >&#x27;foo&#x27;</span></code></pre> <h2 id=traceback_demo ><a href="#traceback_demo" class=header-anchor >Traceback demo</a></h2> <p>Demo...</p> <p>Make sure you read the traceback&#33;</p> <h2 id=catching_exceptions ><a href="#catching_exceptions" class=header-anchor >Catching exceptions</a></h2> <pre><code class="python hljs">number_string = <span class=hljs-built_in >input</span>(<span class=hljs-string >&quot;Please enter a number: &quot;</span>)
<span class=hljs-keyword >try</span>:
    number = <span class=hljs-built_in >int</span>(number_string)
<span class=hljs-keyword >except</span> ValueError:
    <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;Not a valid number. Found &#x27;%s&#x27;&quot;</span> % number_string)</code></pre> <ul> <li><p>Catch exception to handle failure &#40;if expected&#33;&#41;</p> <li><p>Usually best not to catch the exception</p> <li><p>Catch <em>only</em> the exception you expect</p> </ul> <div class=page-foot > <div class=copyright > &copy; Oscar Benjamin. Last modified: February 10, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>