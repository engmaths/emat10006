<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/emat10006/libs/katex/katex.min.css"> <link rel=stylesheet  href="/emat10006/libs/highlight/github.min.css"> <link rel=stylesheet  href="/emat10006/css/franklin.css"> <link rel=stylesheet  href="/emat10006/css/basic.css"> <link rel=icon  href="/emat10006/assets/favicon.png"> <title>Plotting with matplotlib &mdash; Further Computer Programming</title> <header> <div class=blog-name ><a href="">EMAT10006: Further Computer Programming</a></div> <nav> <ul> <li><a href="/emat10006/">Overview</a> <li><a href="/emat10006/materials/">Materials</a> <li><a href="/emat10006/cheatsheet/">Cheatsheet</a> </ul> <img src="/emat10006/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=plotting_with_matplotlib ><a href="#plotting_with_matplotlib" class=header-anchor >Plotting with matplotlib</a></h1> <p>Plotting in Python is usually done using the <code>matplotlib</code> library &#40;although other libraries do exist&#41;. <code>matplotlib</code> is build on top of <code>numpy</code> so that it can use arrays for its internal calculations. You can find the <a href="https://matplotlib.org/">matplotlib website here</a>. The code for matplotlib is on <a href="https://github.com/matplotlib/matplotlib">github</a>.</p> <p>First take a quick look at <a href="https://www.labri.fr/perso/nrougier/teaching/matplotlib/">this tutorial</a>. As in other cases this tutorial has more than we need so don&#39;t feel that you should work through the whole thing &#40;although don&#39;t let me stop you if you want to&#33;&#41;.</p> <p>Here&#39;s an example plotting script:</p> <pre><code class="python hljs"><span class=hljs-comment >#!/usr/bin/env python3</span>

<span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt

x = np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >2</span>*np.pi, <span class=hljs-number >100</span>)
y = np.sin(x)

fig = plt.figure()
ax = fig.add_subplot(<span class=hljs-number >1</span>, <span class=hljs-number >1</span>, <span class=hljs-number >1</span>)
ax.plot(x, y)
plt.show() <span class=hljs-comment ># Show on the *screen</span>

fig.savefig(<span class=hljs-string >&#x27;sine.svg&#x27;</span>)</code></pre> <p>The above code gives us a figure like:</p> <p><img src="/emat10006/assets/basics/sine.svg" alt="" /></p> <p>Normally I would dress this up a bit though so that I end up with something like this:</p> <pre><code class="python hljs"><span class=hljs-comment >#!/usr/bin/env python3</span>

<span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt

<span class=hljs-function ><span class=hljs-keyword >def</span> <span class=hljs-title >main</span>(<span class=hljs-params >filename=<span class=hljs-literal >None</span></span>):</span>
    <span class=hljs-string >&#x27;&#x27;&#x27;Plot sine function and show on screen or save to file&#x27;&#x27;&#x27;</span>

    <span class=hljs-comment ># Set the figure size in inches</span>
    <span class=hljs-comment ># and manually control the axes size</span>
    fig = plt.figure(figsize=(<span class=hljs-number >4</span>, <span class=hljs-number >3</span>))
    ax = fig.add_axes([<span class=hljs-number >0.20</span>, <span class=hljs-number >0.20</span>, <span class=hljs-number >0.70</span>, <span class=hljs-number >0.70</span>])

    <span class=hljs-comment ># Have a function to do the actual plotting to the axes object</span>
    plot_sine(ax)

    <span class=hljs-comment ># Show on screen or save to file if filename is provided</span>
    <span class=hljs-keyword >if</span> filename <span class=hljs-keyword >is</span> <span class=hljs-literal >None</span>:
        plt.show()
    <span class=hljs-keyword >else</span>:
        fig.savefig(filename) <span class=hljs-comment ># Format chosen by extension</span>


<span class=hljs-function ><span class=hljs-keyword >def</span> <span class=hljs-title >plot_sine</span>(<span class=hljs-params >ax</span>):</span>
    numpoints = <span class=hljs-number >100</span>
    x = np.linspace(<span class=hljs-number >0</span>, <span class=hljs-number >2</span>*np.pi, numpoints)
    y = np.sin(x)

    ax.plot(x, y, color=<span class=hljs-string >&#x27;black&#x27;</span>, linewidth=<span class=hljs-number >3</span>)
    ax.set_xlim([<span class=hljs-number >0</span>, np.pi])
    ax.set_ylim([-<span class=hljs-number >1</span>, <span class=hljs-number >1</span>])

    <span class=hljs-comment ># Use LaTeX for text</span>
    ax.set_xlabel(<span class=hljs-string >r&#x27;$x$&#x27;</span>)
    ax.set_ylabel(<span class=hljs-string >r&#x27;$\sin{x}$&#x27;</span>, rotation=<span class=hljs-number >0</span>)

    <span class=hljs-comment ># Manually control axes ticks</span>
    ax.set_xticks([<span class=hljs-number >0</span>, np.pi/<span class=hljs-number >2</span>, np.pi, <span class=hljs-number >3</span>*np.pi/<span class=hljs-number >2</span>, <span class=hljs-number >2</span>*np.pi])
    ax.set_xticklabels([
        <span class=hljs-string >r&#x27;$0$&#x27;</span>,
        <span class=hljs-string >r&#x27;$\frac{\pi}{2}$&#x27;</span>,
        <span class=hljs-string >r&#x27;$\pi$&#x27;</span>,
        <span class=hljs-string >r&#x27;$\frac{3\pi}{2}$&#x27;</span>,
        <span class=hljs-string >r&#x27;$2\pi$&#x27;</span>,
    ], fontsize=<span class=hljs-string >&#x27;large&#x27;</span>)
    ax.set_yticks([-<span class=hljs-number >1</span>, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>])


<span class=hljs-keyword >if</span> __name__ == <span class=hljs-string >&quot;__main__&quot;</span>:
    <span class=hljs-keyword >import</span> sys
    main(*sys.argv[<span class=hljs-number >1</span>:])</code></pre> <p>We can show the plot on the screen by running this script like:</p> <pre><code class="bash hljs">python sine2.py <span class=hljs-comment ># shows on the screen</span></code></pre>
<p>or we can save it to a file &#40;format determined by filename extension&#41; with:</p>
<pre><code class="bash hljs">python sine2.py sin2.pdf <span class=hljs-comment ># saves to file</span></code></pre>
<p>The resulting figure looks like:</p>
<p><img src="/emat10006/assets/basics/sine2.svg" alt="" /></p>
<h2 id=exercises ><a href="#exercises" class=header-anchor >Exercises</a></h2>
<ol>
<li><p>Create a script that uses <code>odeint</code> to solve the ODE <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo>=</mo><mo>−</mo><msup><mi>ω</mi><mn>2</mn></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">\ddot{x} = -\omega^2
   x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span> with initial conditions <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x(0) = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\dot{x}(0) = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> and plots <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span>.</p>

<li><p>Adapt the above so that it plots both <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\dot{x}(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> in different colours. Use a legend to indicate which is which and ensure that all axes are properly labelled. Adjust linewidth, colours, ticks etc to make the figure look better.</p>

<li><p>Adapt the above so that your figure has two subplots. One should be rectangular and as above. The other subplot appear below and should be the same width but square &#40;how can you make it exactly square?&#41;. The lower subplot should show the solution in the <em>phase plane</em> i.e. it should show the trajectory in the space with axes <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span>. Ensure that all axes etc are labelled.</p>

<li><p>Adapt the above so that it is a script that you can run as <code>python
   myscript.py 3 # Sets omega to 3</code> or <code>python myscript.py 3 myfigure.pdf</code>.</p>

<li><p>Given a function of two variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(x, y) = \frac{1}{1 + x^2 + y^2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.326216em;vertical-align:-0.481108em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> create a script that will plot the function as a &quot;heat map&quot;. Can you get the axes ticks correct? Can you change the color scheme?</p>

<li><p>Create a script that will generate a CSV file with two columns of approximately random numbers representing two correlated variables. Make a script that can read this CSV file and show the result as a scatter plot.</p>

</ol>
<div class=page-foot >
  <div class=copyright >
    &copy; Oscar Benjamin. Last modified: February 25, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>