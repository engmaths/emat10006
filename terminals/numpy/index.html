<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/emat10006/libs/katex/katex.min.css"> <link rel=stylesheet  href="/emat10006/libs/highlight/github.min.css"> <link rel=stylesheet  href="/emat10006/css/franklin.css"> <link rel=stylesheet  href="/emat10006/css/basic.css"> <link rel=icon  href="/emat10006/assets/favicon.png"> <title>Scientific libraries in Python &mdash; Scientific Computing</title> <header> <div class=blog-name ><a href="">EMAT10006: Further Computer Programming</a></div> <nav> <ul> <li><a href="/emat10006/">Overview</a> <li><a href="/emat10006/terminals/">Terminals</a> </ul> <img src="/emat10006/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=scientific_libraries_in_python ><a href="#scientific_libraries_in_python">Scientific libraries in Python</a></h1> <p>Python is a general purpose programming language that can be used for making many different types of program. Because of this it does not come automatically equipped with libraries for doing scientific work - this is why I advised to install Anaconda Python rather than use the normal &quot;Python&quot; installer. This does not mean that Python is not suitable for scientific work. We just need to understand that we should install the scientific bits on top. They don&#39;t come included because many people use Python for other things.</p> <h2 id=numpyscipy ><a href="#numpyscipy">Numpy/scipy</a></h2> <p>The main scientific Python package that we want is called <code>numpy</code> but we also want <code>scipy</code>. Test that you have them installed with</p> <pre><code class="python hljs"><span class=hljs-meta >&gt;&gt;&gt; </span><span class=hljs-keyword >import</span> numpy
<span class=hljs-meta >&gt;&gt;&gt; </span><span class=hljs-keyword >import</span> scipy</code></pre> <p>If nothing happens they are installed.</p> <p>Briefly <code>numpy</code> provides us with:</p> <ol> <li><p>A fundamental N-dimensional array type that we can use for representing vectors, matrices, and higher-order tensors. This is very similar to arrays in Matlab - and not the same as lists, tuples, etc in Python.</p> <li><p>An interface to a BLAS library for doing standard linear algebra operations &#40;matrix multiplication, solving linear systems etc&#41;</p> <li><p>Routines for Fourier Transforms</p> <li><p>Routines for different kinds of random numbers</p> <li><p>Some other commonly used scientific stuff.</p> </ol> <p>We also want <code>scipy</code> which provides:</p> <ol> <li><p>Signal processing</p> <li><p>Optimisation routines &#40;minimisation, root-finding etc.&#41;</p> <li><p>&quot;Special&quot; functions &#40;obscure mathematical functions&#41;</p> <li><p>Sparse matrices</p> <li><p>Integration routines</p> <li><p>Stats stuff.</p> <li><p>Loads more stuff that I don&#39;t know about</p> </ol> <p>For our purposes numpy and scipy are basically the same thing but arbitrarily divided into two different packages.</p> <p>You can find a quick tutorial on <a href="https://numpy.org/doc/stable/user/quickstart.html">numpy here</a>. There is also <a href="https://numpy.org/doc/stable/user/numpy-for-matlab-users.html">this page</a> which notes the important differences between Matlab and numpy. You can also find the code for both <a href="https://github.com/numpy/numpy">numpy</a> and <a href="https://github.com/scipy/scipy">scipy</a> on GitHub.</p> <h2 id=matrices_or_arrays ><a href="#matrices_or_arrays">Matrices or arrays?</a></h2> <p>Numpy has a function <code>matrix</code> which creates a &quot;matrix&quot; instead of a 2D array. Do <em>not</em> use this function. Never use it. More information can be found <a href="https://numpy.org/doc/stable/user/numpy-for-matlab-users.html">here</a>. When I say &quot;matrix&quot; below I mean that you should create a 2D array using the <code>array</code> function.</p> <h2 id=exercises ><a href="#exercises">Exercises</a></h2> <ol> <li><p>Given a numpy array <code>a &#61; np.array&#40;&#91;1, 2, 3&#93;&#41;</code> what does <code>a&#43;a</code> give us and what about <code>a*3</code>? What would happen if <code>a</code> were a list <code>a&#61;&#91;1, 2, 3&#93;</code> instead?</p> <li><p>How do you create a matrix using Numpy?</p> <li><p>Given two matrices <code>M1</code> and <code>M2</code> what does <code>M1 * M2</code> give us? How do we compute the <em>matrix product</em> of two matrices instead? &#40;Compare with Matlab&#41;</p> <li><p>Given a Matrix <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >M</mi></mrow><annotation encoding="application/x-tex">\mathrm{M}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord ><span class="mord mathrm">M</span></span></span></span></span> and vector <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >b</mi></mrow><annotation encoding="application/x-tex">\mathrm{b}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord ><span class="mord mathrm">b</span></span></span></span></span> how do I compute the solution <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >x</mi></mrow><annotation encoding="application/x-tex">\mathrm{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class=mord ><span class="mord mathrm">x</span></span></span></span></span> of the system of equations <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >M</mi><mtext> </mtext><mi mathvariant=normal >x</mi><mo>=</mo><mi mathvariant=normal >b</mi></mrow><annotation encoding="application/x-tex">\mathrm{M\,x = b}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord ><span class="mord mathrm">M</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathrm">b</span></span></span></span></span></p> <li><p>How do I sum a matrix along its rows/columns?</p> <li><p>How do I generate a matrix of random numbers that are normally distributed? What about numbers uniformly distributed between 0 and 1?</p> <li><p>How do I slice a matrix to cut off the last row and the last column?</p> <li><p>Give a Matrix <code>M</code> what does <code>M&lt;2</code> give us?</p> <li><p>What about <code>M&#91;M&lt;2&#93;</code>?</p> <li><p>What about <code>M&#91;1&lt;M&lt;2&#93;</code> or <code>M&#91;1&lt;M and M &lt; 2&#93;</code> or <code>M&#91;&#40;1&lt;M&#41; &amp; &#40;M&lt;2&#41;&#93;</code>?</p> <li><p>What about about <code>M&#91;1:-1,1:-1&#93;</code> or <code>M&#91;&#91;1, 2&#93;, &#91;1, 2&#93;&#93;</code>?</p> <li><p>How can you find the determinant of a matrix, or the transpose?</p> <li><p>What about the eigenvectors and eigenvalues?</p> <li><p>How do we create vectors/matrices of 64-bit floats? What about 8-bit unsigned integers?</p> <li><p>If <code>M</code> is a vector of <em>unsigned</em> integers what does <code>M&#91;:&#93; &#61; -1</code> do?</p> <li><p>Explore the memory use of matrices using the <code>nbytes</code> attribute. Can you make sense of it?</p> <li><p>The function <code>odeint</code> is described in the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html">docs</a> Use it to solve the ODE <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\dot{x} = x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> with initial condition <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x(0)=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>. The true solution has <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo>=</mo><mi mathvariant=normal >e</mi></mrow><annotation encoding="application/x-tex">x(1)=\mathrm{e}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class=mord ><span class="mord mathrm">e</span></span></span></span></span> so what is the error in the numerical estimate of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x(1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span></span></span></span>?</p> <li><p>How do we use <code>odeint</code> to solve a second order ODE e.g. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo>=</mo><mo>−</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\ddot{x} = -x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=mord >−</span><span class="mord mathnormal">x</span></span></span></span>? What is the error in the numerical estimate of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x(1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span></span></span></span>?</p> </ol> <div class=page-foot > <div class=copyright > &copy; Oscar Benjamin. Last modified: January 29, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>